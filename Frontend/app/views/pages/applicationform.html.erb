<div class="custom-container">
  <div class="left-div">
    <%= render 'shared/left_toggle-sidebar' %>
  </div>
  <div class="right-div">
    <%= render 'shared/right_header' %>
    

    <div class="content">
      <div class="form-container">
        <div class="section">
          <h1 id="tab6">Personal Information</h1>

          <div class="form-name">
            <div class="form-name-left">
              <h2>Title</h2>
              <select id="title" name="title" class="form-control">
                <option value="">Select</option>
                <option value="mr">Mr.</option>
                <option value="mrs">Mrs.</option>
                <option value="ms">Ms.</option>
                <option value="dr">Dr.</option>
              </select>
            </div>
            <div class="form-name-right">
              <h2>Your name as in NRIC/Passport</h2>
              <input type="text" id="name"/>
            </div>
          </div>

          <div class="form-preferredname">
            <%= image_tag("DBS_Black_Visa_Card_Small.png", alt: "DBS_Black_Visa_Card_Small", class: "dbs_blackvisacard_image") %>
            <h2>Your preferred name to appear on the card(s)</h2>
            <input type="text"/>
          </div>

          <div>
            <h2>Date of Birth</h2>
            <input type="date" value="<%= @user&.date_of_birth %>"/>
          </div>

          <div>
            <h2>Gender</h2>
            <select>
              <option value="other">Others</option>
              <option value="male">Male</option>
              <option value="female">Female</option>
            </select>
          </div>
        </div>

        <div class="section">
          <h1 id="tab7">Contact Information</h1>
          <div>
            <h2>Mobile Number</h2>
            <input type="text" id="mobile-number"/>
            <span id="mobile-number-validation"></span>
          </div>
          <div>
            <h2>Email Address</h2>
            <input type="text"/>
          </div>
          <div>
            <h2>Home Number</h2>
            <input type="text"/>
          </div>
          <div>
            <h2>Office Number</h2>
            <input type="text"/>
          </div>
        </div>

        <div class="section">
          <h1 id="tab8">Passport Details</h1>
          <div>
            <h2>Nationality</h2>
            <input type="text"/>
          </div>
          <div>
            <h2>Passport Number</h2>
            <input type="text" value="<%= @user&.passport_number %>"/>
          </div>
          <div>
            <h2>Passport Expiry Date</h2>
            <input type="date" value="<%= @user&.passport_expiry %>"/>
          </div>
        </div>

        <%# Residential Portion %>
        <div class="residential-container section" id="tab5">
          <h1 id="tab9">Residential Details</h1>

          <h2>Residential Address</h2>
          <div class="residential-address-layer1">
            <h4>Postal Code</h4>
            <input type="text"/>
          </div>
          <div class="residential-address-layer2">
            <div class="residential-address-layer2-left">
              <h4>Block/House Number</h4>
              <input type="text"/>
            </div>
            <div class="residential-address-layer2-right">
              <h4>Street Name 1</h4>
              <input type="text"/>
            </div>
          </div>
          <div class="residential-address-layer3">
            <h4>Street Name 2</h4>
            <input type="text"/>
          </div>
          <div class="residential-address-layer4">
            <h4>Street Name 3</h4>
            <input type="text"/>
          </div>
          <div class="residential-address-layer5">
            <h4>Unit Number</h4>
            <input type="text"/>
          </div>

          <div class="residence-type">
            <h2>Type of residence</h2>
            <div class="residence-type-toggle-buttons">
              <button class="residence-type-toggle-button" id="hdb">HDB</button>
              <button class="residence-type-toggle-button" id="condo">Condo/Apt</button>
              <button class="residence-type-toggle-button" id="landed">Landed</button>
              <button class="residence-type-toggle-button" id="others">Others</button>
            </div>
          </div>

          <div class="residence-status">
            <h2>Your residential status</h2>
            <div class="residence-status-toggle-buttons">
              <button class="residence-status-toggle-button" id="ownedFP">Owned (Fully Paid)</button>
              <button class="residence-status-toggle-button" id="ownedM">Owned (Mortgaged)</button>
              <button class="residence-status-toggle-button" id="rented">Rented</button>
              <button class="residence-status-toggle-button" id="parents">Parents'</button>
              <button class="residence-status-toggle-button" id="employers">Employer's</button>
              <button class="residence-status-toggle-button" id="others">Others</button>
            </div>
          </div>

          <h2>Number of years at this residence</h2>
          <div class="residential-years">
            <div class="residential-years-left">
              <input type="text"/>
            </div>
            <div class="residential-years-right">
              <h4>Years</h4>
            </div>
          </div>
        </div>

        <%# Education level %>
        <div class="section">
          <h1 id="tab10">Professional Details</h1>
          <div class="education-level">
            <h2>Your education level</h2>
            <div class="education-level-toggle-buttons">
              <button class="education-level-toggle-button" id="uni">University/Post-Grad</button>
              <button class="education-level-toggle-button" id="diploma">Diploma</button>
              <button class="education-level-toggle-button" id="alevel">'A'-level/Pre-University</button>
              <button class="education-level-toggle-button" id="secondary">Secondary</button>
              <button class="education-level-toggle-button" id="technical">Technical</button>
              <button class="education-level-toggle-button" id="others">Others</button>
            </div>
          </div>

          <%# Occupation %>
          <h2>Your occupation</h2>
          <div class="occupation"> 
            <select id="title" name="title" class="form-control">
              <option selected="selected" value="" class="">Please Select Here</option>
              <option label="Senior Management" value="string:01">Senior Management</option>
              <option label="Director" value="string:12">Director</option>
              <option label="Professional" value="string:02">Professional</option>
              <option label="Executive" value="string:04">Executive</option>
              <option label="Teacher" value="string:27">Teacher</option>
              <option label="Managerial" value="string:03">Managerial</option>
              <option label="Supervisor" value="string:19">Supervisor</option>
              <option label="Sales" value="string:06">Sales</option>
              <option label="Diplomat" value="string:50">Diplomat</option>
              <option label="Others" value="string:10">Others</option>
            </select>
          </div>

          <%# Job Industry %>
          <h2>Your job industry</h2>
          <div class="occupation"> 
            <select id="title" name="title" class="form-control">
              <option selected="selected" value="" class="">Please Select Here</option>
              <option label="IT/Telco" value="string:05">IT/Telco</option>
              <option label="Retail" value="string:27">Retail</option>
              <option label="Banking &amp; Finance" value="string:04">Banking &amp; Finance</option>
              <option label="Government" value="string:11">Government</option>
              <option label="Shipping/ Transport" value="string:20">Shipping/ Transport</option>
              <option label="Building/ Construction" value="string:02">Building/ Construction</option>
              <option label="Travel Related" value="string:29">Travel Related</option>
              <option label="Insurance" value="string:24">Insurance</option>
              <option label="Hotel/ Restaurant" value="string:23">Hotel/ Restaurant</option>
              <option label="Entertainment" value="string:22">Entertainment</option>
              <option label="Manufacturing/ Production" value="string:17">Manufacturing/ Production</option>
              <option label="Others" value="string:19">Others</option></select>
            </select>
          </div>

          <%# Your Company Name %>
          <div>
            <h2>Your Company name</h2>
            <input type="text"/>
          </div>

          <div>
            <h2>Monthly Income</h2>
            <div class="input-container">
              <h3>S$</h3>
              <input type="text" />
            </div>
          </div>

          <div>
            <h2>Your preferred credit limit</h2>
            <div>
              <h5>For explanatory notes on Credit Limit, click <a href="https://www.dbs.com.sg/infopath_resources/pdf/dbsform/Terms_And_Conditions/dbs_credit_cards_credit_limit_review_tncs_declaration.pdf" target="_blank">here</a></h5>
            </div>
            <div>
              <button class="current-job-status-toggle-button" id="bank-limit" onclick="toggleContent('bank-limit')">Limit granted by the Bank</button>
            </div>
            <div>
              <h5 class="spaced-h5">I have no preference for the credit limit on my account. I understand that DBS has the right to determine the credit limit at its absolute discretion.</h5>
            </div>
            <div>
              <button class="current-job-status-toggle-button" id="self-limit" onclick="toggleContent('self-limit')">I would like to specify a limit</button>
            </div>
            <div class="hidden-content" id="self-credit-limit">
              <h5>I consent to be granted a credit limit that is no more than the above indicated amount. I understand that DBS has the right to determine the credit limit at its absolute discretion. Preferred credit limit should be at a minimum of S$500 and in multiples of S$100.</h5>
              <div class="hidden-container">
                <h3>S$</h3>
                <input type="text" />
              </div>
            </div>
            
          </div>

          <%# Length of Current Employment  %>
          <h2 class="spaced-h2">Length of Current Employment</h2>
          <div class="length-current-employment"> 
            <div class= "length-current-employment-1">
              <input type="text"/>          
            </div>
            <div class= "length-current-employment-2">
              <h4>Years</h4>
            </div>
            <div class= "length-current-employment-3">
              <input type="text"/>          
            </div>
            <div class= "length-current-employment-4">
              <h4>Months</h4>
            </div>
          </div>

          <%# Marital Status%>
          <div>
            <h2>Marital Status</h2>
            <div class="current-job-status-toggle-buttons">
              <button class="current-job-status-toggle-button" id="single">Single</button>
              <button class="current-job-status-toggle-button" id="married">Married</button>
              <button class="current-job-status-toggle-button" id="divorced">Divorced</button>
              <button class="current-job-status-toggle-button" id="others">Others</button>
            </div>
          </div>

          <%# Number of dependents%>
          <div>
            <h2>Number of dependents</h2>
            <div class="input-container">
              <input type="text" />
            </div>
          </div>
        
          <%# Mailing Address %>
          <div class="mailing-address"> 
            <h2>Your current job status</h2>
            <div class="mailing-address-toggle-buttons">
              <button class="mailing-address-toggle-button" id="residential">Residential</button>
              <button class="mailing-address-toggle-button" id="office">Office</button>
            </div>
          </div>

          <%# Your current office address %>
          <h2>Your current office address</h2>
          <div class ="current-office-address-layer1">
            <h4>Postal Code</h4>
            <input type="text"/>
          </div>
          <div class= "current-office-address-layer2">
            <div class= "current-office-address-layer2-left">
              <h4>Block/House Number</h4>
              <input type="text"/>          
            </div>
            <div class= "current-office-address-layer2-right">
              <h4>Street Name 1</h4>
              <input type="text"/>          
            </div>
          </div>
          <div class ="current-office-address-layer3">
            <h4>Street Name 2</h4>
            <input type="text"/>
          </div>
          <div class ="current-office-address-layer4">
            <h4>Street Name 3</h4>
            <input type="text"/>
          </div>
          <div class ="current-office-address-layer5">
            <h4>Unit Number</h4>
            <input type="text"/>
          </div>
        </div>

        <%# Promo Code / Fine Prints / Continue Button %>
        <div class="clearfix relative">
          <input type="checkbox"> 
          <label class="label " for="promo" data-focus="first" data-tab="true">
            I have a promo code for this application
          </label>
        </div>
        <div class="clearfix agreement">
          By clicking on the Continue button below, I have read and agreed to be bound by the <a href="https://www.dbs.com.sg/iwov-resources/pdf/cards/credit-card-declaration.pdf" target="_new"><u>declaration, important notes, fee and charges.</u></a>
        </div>
        <br/>
        <button type="submit">Continue</button>
      </div>
    </div>
  </div>
</div>

<script>
  //Show hidden credit limit
  function toggleContent(buttonId){
    var content = document.getElementById("self-credit-limit");

    if (buttonId === "self-limit") {
      content.style.display = content.style.display = (content.style.display === "none" || content.style.display === "") ? "block" : "none";
    } else {
      content.style.display = "none";
    }
  }

  //Mobile Number validation
  document.addEventListener("DOMContentLoaded", () => {
    const mobileNumberInput = document.getElementById("mobile-number");
    const validationMessage = document.getElementById("mobile-number-validation");

    const titleField = document.getElementById('title');
    const nameField = document.getElementById('name');
    const buttonHolder = document.querySelector('.button-holder');

    function buttonVisibility() {
      if (titleField.value && titleField.value !== "" && nameField.value.trim()){
        buttonHolder.style.visibility = 'visible';
      } else {
        buttonHolder.style.visibility = 'hidden';
      }
    }

    titleField.addEventListener('change', buttonVisibility);
    nameField.addEventListener('input', buttonVisibility);

    mobileNumberInput.addEventListener("blur", async () => {
      const mobileNumber = mobileNumberInput.value;

      try {
        const response = await fetch(`http://127.0.0.1:4567/validate?mobile_number=${mobileNumber}`);
        const result = await response.json();

        if (result.valid_mobile_number) {
        } else {
          validationMessage.textContent = "Invalid mobile number.";
          validationMessage.style.color = "red";
        }
      } catch (error) {
        validationMessage.textContent = "Error validating mobile number.";
        validationMessage.style.color = "red";
      }
    });

    buttonVisibility();
  });

  //Toggle Button JS (Residence Type)
  document.addEventListener("DOMContentLoaded", function() {
    const buttons = document.querySelectorAll(".residence-type-toggle-button");
    buttons.forEach(button => {
      button.addEventListener("click", function() {
        buttons.forEach(btn => btn.classList.remove("active"));
        this.classList.add("active");
      });
    });
  });
  //Toggle Button JS (Residential Status)
  document.addEventListener("DOMContentLoaded", function() {
    const buttons = document.querySelectorAll(".residence-status-toggle-button");
    buttons.forEach(button => {
      button.addEventListener("click", function() {
        buttons.forEach(btn => btn.classList.remove("active"));
        this.classList.add("active");
      });
    });
  });
  //Toggle Button JS (Education Level)
  document.addEventListener("DOMContentLoaded", function() {
    const buttons = document.querySelectorAll(".education-level-toggle-button");
    buttons.forEach(button => {
      button.addEventListener("click", function() {
        buttons.forEach(btn => btn.classList.remove("active"));
        this.classList.add("active");
      });
    });
  });
  //Toggle Button JS (Current Job Status)
  document.addEventListener("DOMContentLoaded", function() {
    const buttons = document.querySelectorAll(".current-job-status-toggle-button");
    buttons.forEach(button => {
      button.addEventListener("click", function() {
        buttons.forEach(btn => btn.classList.remove("active"));
        this.classList.add("active");
      });
    });
  });
  //Toggle Button JS (Mailing Address)
  document.addEventListener("DOMContentLoaded", function() {
    const buttons = document.querySelectorAll(".mailing-address-toggle-button");
    buttons.forEach(button => {
      button.addEventListener("click", function() {
        buttons.forEach(btn => btn.classList.remove("active"));
        this.classList.add("active");
      });
    });
  });

</script>
