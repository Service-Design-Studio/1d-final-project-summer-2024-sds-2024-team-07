<div class="custom-container">
    <div class="left-div">
        <%= render 'shared/left_toggle-sidebar' %>
    </div>
    <div class="right-div">
        <%= render 'shared/right_header' %>
        <div class="btn-group">
            <button type="button" onclick="showTabGroup(1)" id=button1 class="btn btn-outline-danger">Salaried Employer A:<br> More than 3 Months </button>
            <button type="button" onclick="showTabGroup(2)" id=button2 class="btn btn-outline-danger">Salaried Employer B:<br> Less than 3 months</button>
            <button type="button" onclick="showTabGroup(3)" id=button3 class="btn btn-outline-danger">Self-Employed/Commision-Based</button>

        </div>

  <div class="tabs">
    <input type="radio" id="tab1" name="tab-control" checked>
    <input type="radio" id="tab2" name="tab-control">
    <input type="radio" id="tab3" name="tab-control">
    <input type="radio" id="tab4" name="tab-control">
    <input type="radio" id="tab5" name="tab-control">
    <ul>
      <li title="Valid Passport">
        <label id="label1" for="tab1" role="button">
          <div class="icon">📕</div>
          <br><span>Passport</span>
        </label>
      </li>
      <li title= "Employment Pass">
        <label id="label2" for="tab2" role="button">
          <div class="icon">📝</div>
          <br><span>Employment Pass</span>
        </label>
      </li>
      <li id="it" title="Income Tax">
        <label id="label3" for="tab3" role="button">
          <div class="icon">💵</div>
          <br><span>Income Tax</span>
        </label>
      </li>
      <li title="PaySlip">
        <label id="label4" for="tab4" role="button">
          <div class="icon">💼</div>
          <br><span>Pay Slip</span>
        </label>
      </li>
      <li title="Proof of SG Address">
        <label id="label5" for="tab5" role="button">
          <div class="icon">🏠</div>
          <br><span>Proof of Address</span>
        </label>
      </li>
    </ul>
    <div class="content">
      <section id="content1">
        <%=image_tag 'Passport.jpg', alt:"Passport", class: 'content-image' %>
      </section>
      <section id="content2">
        <%=image_tag 'WorkPass.jpg', alt:"Employment Pass", class: 'content-image'  %>
      </section>
      <section id="content3">
        <%=image_tag 'TaxAsessment.jpg', alt:"Income Tax", class: 'content-image' %>
      </section>
      <section id="content4">
        <%=image_tag 'IncomeSlip.jpg', alt:"Pay Slip", class: 'content-image' %>
      </section>

      <section id="content5" class="carousel" data-carousel>
        
      <button class="carousel-button prev" data-carousel-button="prev">&#60;</button>
      <button class="carousel-button next" data-carousel-button="next">&#62;</button>
      <ul data-slides>
        <li class="slide" data-active>
          <%=image_tag 'poa.jpg', alt:"Proof of Address", class: 'content-image' %>
        </li>
        <li class="slide">
          <%=image_tag 'poa1.jpg', alt:"Proof of Address1", class: 'content-image' %>
        </li>
        <li class="slide">
          <%=image_tag 'poa2.jpg', alt:"Proof of Address2", class: 'content-image' %>
        </li>
      </ul>
      </section>

    </div>
    

        <div class="upload-btn-wrapper">
          <p>Drop your files here or</p>
          <button class="btnUp">UPLOAD ▼</button>
          <input type="file" name="myfile" />
        </div>

        <div style="text-align: right">
        <%= link_to 'Next', pages_applicationform_path, class: 'Next' %>
        </div>
    </div>
</div>



<script>
document.addEventListener("DOMContentLoaded", function () {
  const tabsContainer = document.querySelector(".tabs");
  const tabs = tabsContainer.querySelectorAll("input[type='radio']");
  const labels = tabsContainer.querySelectorAll("label");
  const indicator = tabsContainer.querySelector(".indicator");
  const fileInput = document.querySelector(".upload-btn-wrapper input[type='file']");
  const contentSections = tabsContainer.querySelectorAll(".content section");

  function updateIndicator() {
    const activeTab = Array.from(tabs).find(tab => tab.checked);
    if (activeTab) {
      const label = tabsContainer.querySelector(`label[for="${activeTab.id}"]`);
      const labelRect = label.getBoundingClientRect();
      const containerRect = tabsContainer.getBoundingClientRect();
      
      indicator.style.width = `${labelRect.width}px`;
      indicator.style.transform = `translateX(${labelRect.left - containerRect.left}px)`;
    }
  }

  tabs.forEach(tab => {
    tab.addEventListener("change", updateIndicator);
  });

  function resetTabs() {
    labels.forEach(label => {
      label.parentElement.style.display = 'none';
      label.control.disabled = true;
    });
    document.getElementById('label3').parentElement.style.display = 'block';  // Show Income Tax by default
    document.getElementById('tab3').disabled = false;
    document.getElementById('label4').parentElement.style.display = 'block';  // Show Pay Slip by default
    document.getElementById('tab4').disabled = false;
  }

  function restoreTabs(tabIds) {
    tabIds.forEach(id => {
      const tab = document.getElementById(id);
      const label = document.querySelector(`label[for='${id}']`);
      tab.disabled = false;
      label.parentElement.style.display = 'block';
    });
  }

  function showTabGroup(groupNumber) {
    resetTabs();

    var buttons = document.querySelectorAll('.btn-group .btn');
    buttons.forEach(function(button) {
      button.classList.remove('active');
    });

    // Add the 'active' class to the clicked button
    var clickedButton = document.getElementById('button' + groupNumber);
    clickedButton.classList.add('active');

    if (groupNumber === 1) {
      restoreTabs(['tab1', 'tab2', 'tab3', 'tab4', 'tab5']);
    } else if (groupNumber === 2) {
      restoreTabs(['tab1', 'tab2', 'tab4', 'tab5']);
      document.getElementById('label3').parentElement.style.display = 'none';
      document.getElementById('tab3').disabled = true;
    } else if (groupNumber === 3) {
      restoreTabs(['tab1', 'tab2', 'tab3', 'tab5']);
      document.getElementById('label4').parentElement.style.display = 'none';
      document.getElementById('tab4').disabled = true;
    }

    updateIndicator();
  }

  function showContent(activeTabId) {
    contentSections.forEach(section => {
      section.style.display = "none";
    });
    document.querySelector(`#content${activeTabId.slice(-1)}`).style.display = "block";
  }

  function clickNextLabel() {
    const activeTab = Array.from(tabs).find(tab => tab.checked);
    if (activeTab) {
      const activeIndex = Array.from(tabs).indexOf(activeTab);
      let nextIndex = (activeIndex + 1) % tabs.length;
      
      while (tabs[nextIndex].disabled) {
        nextIndex = (nextIndex + 1) % tabs.length;
      }
      
      tabs[nextIndex].checked = true;
      labels[nextIndex].click();
      showContent(tabs[nextIndex].id);
      updateIndicator();
    }
  }

  fileInput.addEventListener("change", clickNextLabel);

  document.getElementById('button1').addEventListener('click', () => showTabGroup(1));
  document.getElementById('button2').addEventListener('click', () => showTabGroup(2));
  document.getElementById('button3').addEventListener('click', () => showTabGroup(3));

  // Initialize tab group 1 by default
  showTabGroup(1);

  // Update the indicator on load
  updateIndicator();
  showContent('tab1');
});

</script>